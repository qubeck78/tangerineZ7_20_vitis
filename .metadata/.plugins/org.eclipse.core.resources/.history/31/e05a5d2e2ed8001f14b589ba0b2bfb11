#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include "platform.h"

#include "bsp.h"
#include "osAlloc.h"
#include "osFile.h"
#include "gfFont.h"
#include "gfBitmap.h"
#include "gfJPEG.h"
#include "gfDrawing.h"
#include "osUIEvents.h"

int main()
{
   init_platform();
   bspInit();

   screen.flags      = 0;
   screen.width      = 320;
   screen.height     = 240;
   screen.rowWidth   = 320;
   screen.buffer     = (void*)0x41000000;   //fixed frame buffer location for now

   setVideoMode( _VIDEOMODE_320_TEXT80_OVER_GFX );

   gfFillRect( &screen, 0, 0, 319, 239, gfColor( 0, 0, 0) );

   printf( "\n" );
   printf( "        |.\\__/.|    (~\\ \n" );
   printf( "        | O O  |     ) ) \n" );
   printf( "      _.|  T   |_   ( (  \n" );
   printf( "   .-- ((---- ((-------------.\n" );
   printf( "   | Zynq MP3Player 20250119 |\n" );
   printf( "   |     tangerine Z7_20     |\n" );
   printf( "   |     SOC:%08x        |\n", (int)bsp->version );
   printf( "   `-------------------------`\n" );
   printf( "\n\n\n");


   osFInit();
   osUIEventsInit();


   i = 0;
   j = 1;
   do
   {
      if( !osGetUIEvent( &event ) )
      {
          if( event.type == OS_EVENT_TYPE_KEYBOARD_KEYPRESS )
          {
             //printf( "%02x ", event.arg1 );
             printf( "%c", event.arg1 );
             fflush( stdout );

             if( event.arg1 == 27 )
             {
                j = 0;
             }
          }
      }
   }while( 1 );


}
